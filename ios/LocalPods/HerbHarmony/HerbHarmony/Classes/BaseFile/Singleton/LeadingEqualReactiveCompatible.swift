
//: Declare String Begin

/*: "fee" :*/
fileprivate let str_recordValue:String = "ftext"

/*: "VIPFee" :*/
fileprivate let str_equalColorName:String = "between at network button addVIPFee"

/*: "chattingNum" :*/
fileprivate let str_mapName:String = "chatable"
fileprivate let str_managerMainData:String = "tingNumobserver case if"

/*: "You're already in her live room" :*/
fileprivate let str_valueTitle:[UInt8] = [0x1f,0x29,0x33,0x61,0x34,0x23,0x66,0x27,0x2a,0x34,0x23,0x27,0x22,0x3f,0x66,0x2f,0x28,0x66,0x2e,0x23,0x34,0x66,0x2a,0x2f,0x30,0x23,0x66,0x34,0x29,0x29,0x2b]

private func lineWill(video num: UInt8) -> UInt8 {
    return num ^ 70
}

/*: "toUid" :*/
fileprivate let str_actualData:[UInt8] = [0x7c,0x67,0x5d,0x61,0x6c]

private func targetCountimate(make num: UInt8) -> UInt8 {
    return num ^ 8
}

/*: "momentId" :*/
fileprivate let str_blockData:[UInt8] = [0x28,0x2a,0x28,0x20,0x2b,0x31,0xc,0x21]

private func videoLet(clear num: UInt8) -> UInt8 {
    return num ^ 69
}

/*: "extra" :*/
fileprivate let str_attentionContent:[UInt8] = [0xbc,0xcf,0xcb,0xc9,0xb8]

fileprivate func giftView(refuse num: UInt8) -> UInt8 {
    let value = Int(num) - 87
    if value < 0 {
        return UInt8(value + 256)
    } else {
        return UInt8(value)
    }
}

/*: "uid" :*/
fileprivate let str_userText:[UInt8] = [0x81,0x9d,0x90]

/*: "onlineStatus" :*/
fileprivate let str_colorValue:[UInt8] = [0x20,0x1f,0x1d,0x1a,0x1f,0x16,0x4,0x25,0x12,0x25,0x26,0x24]

fileprivate func emptyFile(item num: UInt8) -> UInt8 {
    let value = Int(num) + 79
    if value > 255 {
        return UInt8(value - 256)
    } else {
        return UInt8(value)
    }
}

/*: "isNewUser" :*/
fileprivate let str_photoBottomValue:[UInt8] = [0xac,0xb6,0x8b,0xa0,0xb2,0x90,0xb6,0xa0,0xb7]

private func letMakeMic(from num: UInt8) -> UInt8 {
    return num ^ 197
}

/*: "userStatus" :*/
fileprivate let str_managerValue:[UInt8] = [0x63,0x65,0x73,0x64,0x45,0x62,0x77,0x62,0x63,0x65]

private func playerUser(corner num: UInt8) -> UInt8 {
    return num ^ 22
}

/*: "Account is restricted！" :*/
fileprivate let str_touchTitle:String = "half count action toAccoun"
fileprivate let str_contentTitle:[Character] = [" ","r","e","s","t","r","i","c","t","e","d","！"]

/*: "Failed to enter the chat room. Please try again later" :*/
fileprivate let str_modelData:[UInt8] = [0x77,0x92,0x9a,0x9d,0x96,0x95,0x51,0xa5,0xa0,0x51,0x96,0x9f,0xa5,0x96,0xa3,0x51,0xa5,0x99,0x96,0x51,0x94,0x99,0x92,0xa5,0x51,0xa3,0xa0,0xa0,0x9e,0x5f,0x51,0x81,0x9d,0x96,0x92,0xa4,0x96,0x51,0xa5,0xa3,0xaa,0x51,0x92,0x98,0x92,0x9a,0x9f,0x51,0x9d,0x92,0xa5,0x96,0xa3]

fileprivate func regularPart(color num: UInt8) -> UInt8 {
    let value = Int(num) + 207
    if value > 255 {
        return UInt8(value - 256)
    } else {
        return UInt8(value)
    }
}

/*: "url" :*/
fileprivate let str_blockValue:[Character] = ["u","r","l"]

/*: "userDetail" :*/
fileprivate let str_rawData:String = "key"
fileprivate let str_contentValue:String = "erDetailmodel open accept string a"

/*: "&type=7" :*/
fileprivate let str_modelName:[Character] = ["&","t","y","p","e","=","7"]

/*: "&type=0" :*/
fileprivate let str_temporaryName:String = "var zone&type=0"

/*: "amount" :*/
fileprivate let str_homeValue:[UInt8] = [0x80,0x8c,0x8e,0x94,0x8f,0x95]

private func legalError(log num: UInt8) -> UInt8 {
    return num ^ 225
}

/*: "transparency" :*/
fileprivate let str_blockSectionName:[Character] = ["t","r","a","n","s","p"]
fileprivate let str_centerErrorValue:String = "tabency"

/*: "`%^{}\"[]|\\<>" :*/
fileprivate let str_throughModelText:[Character] = ["`","%","^","{","}","\"","[","]","|","\\","<",">"]

/*: "version= :*/
fileprivate let str_tableValue:String = "version=self view"

/*: &packageId= :*/
fileprivate let str_tapName:[Character] = ["&","p","a","c","k","a","g","e","I","d","="]

/*: &bundleId= :*/
fileprivate let str_userValue:String = "self center content var&bundle"
fileprivate let str_liveData:String = "comment letId="

/*: & :*/
fileprivate let str_inputData:[Character] = ["&"]

/*: ? :*/
fileprivate let str_fileData:String = "room"

//: Declare String End

// __DEBUG__
// __CLOSE_PRINT__
//
//  LeadingEqualReactiveCompatible.swift
//  AbroadTalking
//
//  Created by Hemming on 2022/8/31.
//

//: import UIKit
import UIKit

//: public class LeadingEqualReactiveCompatible: NSObject {
public class LeadingEqualReactiveCompatible: NSObject {
    //: @objc static public let share = LeadingEqualReactiveCompatible()
    @objc public static let share = LeadingEqualReactiveCompatible()
    //: private override init() {}
    override private init() {}
}

//: extension LeadingEqualReactiveCompatible {
extension LeadingEqualReactiveCompatible {
    // MARK: - 随机视频入口

    //: func func__pushToRandomVideoVC(isBeginRand: Bool) {
    func gameShove(isBeginRand: Bool) {
        //: uploadRecord.uploadRecordEvent(eventID: ClickInRandomvideo)
        kLet_voiceText.quantityingTime(eventID: kLet_marginName)
        //: guard TalkingSocketManager.shared.isTalking == false else {
        guard DataSocketDelegate.shared.isTalking == false else {
            //: self.func__showStatusBarErrorMsg(showMsg: kMessage_videoTalking_limit)
            self.atShow(showMsg: kLet_keyTitle)
            //: return
            return
        }
        //: TalkingPermissionTool.checkCameraAndMicrophone { isOpen in
        LaissezPasserThen.polaroidCameraMicrophone { isOpen in
            //: guard isOpen == true else { return }
            guard isOpen == true else { return }
            //: TalkingQuickVideoManager.req_videoMatchCheck() { succeed, result, errorModel in
            NumberimateReactiveCompatible.dismissAction { succeed, result, _ in
                //: guard succeed else { return }
                guard succeed else { return }
                //: let json = JSON(result ?? [String: Any]())
                let json = JSON(result ?? [String: Any]())
                //: let vc = TalkingRandomVideoViewController()
                let vc = MediaShouldReactiveCompatible()
                //: vc.fee = json["fee"].intValue
                vc.fee = json[(str_recordValue.replacingOccurrences(of: "text", with: "ee"))].intValue
                //: vc.vipFee = json["VIPFee"].intValue
                vc.vipFee = json[(String(str_equalColorName.suffix(6)))].intValue
                //: vc.chattingNum = json["chattingNum"].intValue
                vc.chattingNum = json[(str_mapName.replacingOccurrences(of: "table", with: "t") + String(str_managerMainData.prefix(7)))].intValue
                //: vc.isBeginRand = isBeginRand
                vc.isBeginRand = isBeginRand
                //: vc.isFirstRandow = isBeginRand
                vc.isFirstRandow = isBeginRand
                //: self.currentViewController()?.navigationController?.pushViewController(vc, animated: true)
                self.actionController()?.navigationController?.pushViewController(vc, animated: true)
            }
        }
    }

    // MARK: - 完善资料

    //: func func__pushToFillUserInfoVC() {
    func timeFurniture() {
        //: WithAdministratorAppManager.share.userFillInfoMode = UserFillInfoModel.init()
        WithAdministratorAppManager.share.userFillInfoMode = DataInfoModel()
        //: let VC = TalkingLoginGenderVC()
        let VC = EngageGenderVc()
        //: let currentVC = func__getCurrentActivityVC()
        let currentVC = getEqualVc()
        //: if currentVC != nil {
        if currentVC != nil {
            //: currentVC?.navigationController?.pushViewController(VC, animated: true)
            currentVC?.navigationController?.pushViewController(VC, animated: true)
        }
    }

    // MARK: - 绑定邮箱

    /// - Parameters:
    ///   - type: 类型
    ///   - isShowBack: 是否显示返回按钮
    //: func func__pushToLockUserEmailVC(isShowBack: Bool = true) {
    func showPersonLatEmailDataConverterEventJamLock(isShowBack: Bool = true) {
        //: let currentVC = func__getCurrentActivityVC()
        let currentVC = getEqualVc()
        //: if currentVC != nil {
        if currentVC != nil {
            //: if currentVC!.isKind(of: TalkingLoginBindEmailVC.self) ||
            if currentVC!.isKind(of: NumbereractionReactiveCompatible.self) ||
                //: currentVC!.isKind(of: TalkingLoginMainViewController.self) {
                currentVC!.isKind(of: ScaleThen.self)
            {
                //: return
                return
            }
            //: let vc = TalkingLoginBindEmailVC()
            let vc = NumbereractionReactiveCompatible()
            //: vc.isBack = isShowBack
            vc.isBack = isShowBack
            //: currentVC?.navigationController?.pushViewController(vc, animated: true)
            currentVC?.navigationController?.pushViewController(vc, animated: true)
        }
    }

    // MARK: - 跳转个人资料

    //: func func__pushToUserDetailVC(uid: String?) {
    func bindDownFrom(uid: String?) {
        //: guard let currentVC = self.currentViewController() else { return }
        guard let currentVC = self.actionController() else { return }
        //: if let liveVC = currentVC as? TalkingLiveBeautifyViewController, TalkingLiveManager.shared().isLive {
        if let liveVC = currentVC as? ManagerClickViewController, SectionPushListener.cover().isLive {
            // 从主播页跳转个人资料时，切小屏模式
            //: liveVC.topView.miniButtonClick()
            liveVC.topView.textClick()

            //: } else if currentVC.isKind(of: TalkingVoiceRoomViewController.self), TalkingVoiceRoomManager.shared().isParty {
        } else if currentVC.isKind(of: UserViewController.self), StackMThen.estimated().isParty {
            //: TalkingVoiceRoomManager.shared().voiceRoom_mini()
            StackMThen.estimated().dataQueryed()

            //: } else if let profileVC = currentVC as? TalkingUserDetailViewController {
        } else if let profileVC = currentVC as? WeltanschauungViewController {
            // 同一用户的资料页已经在顶部，只刷新
            //: if profileVC.uid == uid {
            if profileVC.uid == uid {
                //: profileVC.requestAllData()
                profileVC.makeData()
                //: return
                return
            }
        }

        //: let vc = TalkingUserDetailViewController(tempUid: uid)
        let vc = WeltanschauungViewController(tempUid: uid)
        //: getNavigationController()?.pushViewController(vc, animated: true)
        navigation()?.pushViewController(vc, animated: true)
    }

    // MARK: - 观众侧进入直播间

    /// 观众侧跳转到直播间
    /// - Parameters:
    ///   - uid: 主播id
    ///   - enterType: 入口
    //: func func_audiencePushToLiveRoomVC(uid: String, enterType: LiveEnterType) {
    func artefactType(uid: String, enterType: DataEnterType) {
        //: guard TalkingPermissionTool.isLiveOrPartyActive() == false else { return }
        guard LaissezPasserThen.equalSize() == false else { return }

        // 同一直播间只能进一次
        //: guard String(TalkingLiveManager.shared().liveRoomModel.streamerInfo.uid) != uid else {
        guard String(SectionPushListener.cover().liveRoomModel.streamerInfo.uid) != uid else {
            //: self.func__showStatusBarErrorMsg(showMsg: "You're already in her live room".localized)
            self.atShow(showMsg: String(bytes: str_valueTitle.map{lineWill(video: $0)}, encoding: .utf8)!.localized)
            //: return
            return
        }
        // 校验接口，通过后进入直播间
        //: TalkingAudienceManager().req_enterLiveRoom(streamerUid: uid) { succeed, result, errorModel in
        StickToAudienceManager().errorInPush(streamerUid: uid) { succeed, result, _ in
            //: guard succeed else { return }
            guard succeed else { return }
            //: guard let livemodel = TalkingLiveRoomModel.deserialize(from: result as? Dictionary) else { return }
            guard let livemodel = ShowHandyJSON.deserialize(from: result as? Dictionary) else { return }
            // 退出之前的直播间
            //: let currentVC = self.func__getCurrentActivityVC()
            let currentVC = self.getEqualVc()
            //: if let vcArr = currentVC?.navigationController?.viewControllers {
            if let vcArr = currentVC?.navigationController?.viewControllers {
                //: for index in 0..<(vcArr.count) {
                for index in 0 ..< (vcArr.count) {
                    //: let vc = vcArr[index]
                    let vc = vcArr[index]
                    //: if vc.isKind(of: TalkingLivePullStreamsViewController.self) == true {
                    if vc.isKind(of: StraddleManagerDelegate.self) == true {
                        //: (vc as! TalkingLivePullStreamsViewController).popCurrentViewController()
                        (vc as! StraddleManagerDelegate).bulgeUp()
                    }
                }
            }

            // 进入新直播间
            //: TalkingLiveManager.shared().liveRoomModel = livemodel
            SectionPushListener.cover().liveRoomModel = livemodel
            //: let liveVc = TalkingLivePullStreamsViewController()
            let liveVc = StraddleManagerDelegate()
            //: liveVc.type = enterType
            liveVc.type = enterType
            //: currentVC?.navigationController?.pushViewController(liveVc, animated: true)
            currentVC?.navigationController?.pushViewController(liveVc, animated: true)
            // 埋点
            //: switch enterType {
            switch enterType {
            //: case .match:
            case .match:
                //: uploadRecord.uploadRecordEvent(eventID: ClickMatchLiveWindowNoP, toUid: uid)
                kLet_voiceText.quantityingTime(eventID: kLet_progressValue, toUid: uid)
            //: case .userDetail:
            case .userDetail:
                //: uploadRecord.uploadRecordEvent(eventID: ClickProfileLiveWindowNoP, toUid: uid)
                kLet_voiceText.quantityingTime(eventID: kLet_postData, toUid: uid)
            //: case .unknown: break
            case .unknown: break
            }
        }
    }

    /// 进入语聊房
    /// - Parameters:
    ///   - roomId: 房间Id（nil：创建房间；有值：进入房间）
    //: func func_pushToVoiceRoomVC(roomId: String? = nil) {
    func jabbing(roomId: String? = nil) {
        //: if TalkingLiveManager.shared().isLive == true {
        if SectionPushListener.cover().isLive == true { // 直播中
            //: func__showStatusBarErrorMsg(showMsg: kMessage_live_limit)
            atShow(showMsg: kLet_userStatusValue)
            //: return
            return
        }
        //: if roomId == TalkingVoiceRoomManager.shared().partyModel.roomId {
        if roomId == StackMThen.estimated().partyModel.roomId { // 返回语聊房
            //: TalkingVoiceRoomManager.shared().voiceRoom_goback()
            StackMThen.estimated().cellTarget()
            //: return
            return
        }
        //: if TalkingVoiceRoomManager.shared().isParty == true {
        if StackMThen.estimated().isParty == true { // 切换语聊房
            //: if roomId != nil {
            if roomId != nil {
                //: TalkingVoiceRoomManager.shared().voiceRoom_switch(roomId: roomId!, beforeRoomId: TalkingVoiceRoomManager.shared().partyModel.roomId)
                StackMThen.estimated().replyNameId(roomId: roomId!, beforeRoomId: StackMThen.estimated().partyModel.roomId)
            }
            //: return
            return
        }
        //: TalkingVoiceRoomManager.shared().voiceRoom_checkAndTurnOn(roomId: roomId)
        StackMThen.estimated().makeRequest(roomId: roomId)
    }

    // MARK: - 跳转聊天

    /// 跳转到消息列表页
    /// - Parameter isHalf: 是否半屏展示
    //: func func__pushToChatListVC(isHalfView: Bool = false) {
    func errorView(isHalfView: Bool = false) {
        //: let vc = TalkingChatListViewController(isHalfView: isHalfView)
        let vc = CleanManagerDelegate(isHalfView: isHalfView)
        //: let currentVC = func__getCurrentActivityVC()
        let currentVC = getEqualVc()
        //: if isHalfView == false {
        if isHalfView == false {
            //: currentVC?.navigationController?.pushViewController(vc, animated: true)
            currentVC?.navigationController?.pushViewController(vc, animated: true)
            //: } else {
        } else {
            //: currentVC?.addChild(vc)
            currentVC?.addChild(vc)
            //: currentVC?.view.addSubview(vc.view)
            currentVC?.view.addSubview(vc.view)
        }
    }

    /// 跳转到消息聊天页
    /// - Parameters:
    ///   - chatID: 对方Id
    ///   - isFrom: 私聊页入口
    /// - Returns: 消息聊天页

    //: func func__pushToPriveteChatVC(chatID: String, isFrom: PrivateChatIsFromEnum = .Normal, completion: ((_ vc: TalkingPrivateChatController) -> Void)? = nil ) {
    func cellRowCompletion(chatID: String, isFrom: VoiceFromEnum = .Normal, completion: ((_ vc: ClassTipsProtocol) -> Void)? = nil) {
        //: guard chatID.count > 0 else { return }
        guard chatID.count > 0 else { return }

        //: if chatID != IconThen.getXiaoMiID() {
        if chatID != IconThen.finishBy() { // 系统消息
            //: ProgressHUD.show()
            StandardProgressHUD.indexRoom()
            //: let param = ["toUid": chatID, "momentId": "0", "extra": "1"]
            let param = [String(bytes: str_actualData.map{targetCountimate(make: $0)}, encoding: .utf8)!: chatID, String(bytes: str_blockData.map{videoLet(clear: $0)}, encoding: .utf8)!: "0", String(bytes: str_attentionContent.map{giftView(refuse: $0)}, encoding: .utf8)!: "1"]
            //: BridgeReactiveCompatible.req_refreshUserChatInfo(param: param) { [weak self] succeed, result, errorModel in
            BridgeReactiveCompatible.nationality(param: param) { [weak self] succeed, result, _ in
                //: ProgressHUD.dismiss()
                StandardProgressHUD.giftTo()
                //: guard let self = self else {return}
                guard let self = self else { return }
                //: guard succeed else { return }
                guard succeed else { return }

                //: let userWrap = CoverThen.func__transformedChatinfo(userDic: result as! Dictionary<String, Any>)
                let userWrap = CoverThen.funcWithoutEqual(userDic: result as! [String: Any])
                //: ChiefThen.cache_updateMsgUserInfoAndPostNotif(with: userWrap)
                ChiefThen.graduatedTable(with: userWrap)
                // 更新消息列表用户在线状态
                //: let userInfo = ["uid": chatID,
                let userInfo = [String(bytes: str_userText.map{$0^244}, encoding: .utf8)!: chatID,
                                //: "onlineStatus": userWrap.onlineStatus,
                                String(bytes: str_colorValue.map{emptyFile(item: $0)}, encoding: .utf8)!: userWrap.onlineStatus,
                                //: "isNewUser":userWrap.isNewUser,
                                String(bytes: str_photoBottomValue.map{letMakeMic(from: $0)}, encoding: .utf8)!: userWrap.isNewUser,
                                //: "userStatus": userWrap.userStatus]
                                String(bytes: str_managerValue.map{playerUser(corner: $0)}, encoding: .utf8)!: userWrap.userStatus]
                //: NotificationCenter.default.post(name: MSGLIST_UPDATE_ONLINESTATUS_NOTIFICATION,
                NotificationCenter.default.post(name: kLet_likeValue,
                                                //: object: nil,
                                                object: nil,
                                                //: userInfo: userInfo)
                                                userInfo: userInfo)
                //: if userWrap.userStatus == 3 {
                if userWrap.userStatus == 3 { /// 被封号
                    //: self.func__showStatusBarErrorMsg(showMsg: "Account is restricted！".localized)
                    self.atShow(showMsg: (String(str_touchTitle.suffix(6)) + "t is" + String(str_contentTitle)).localized)
                    //: return
                    return
                }
                //: DispatchQueue.main.async {
                DispatchQueue.main.async {
                    //: let chatVC = self.func__canPushToPriveteChatVC(chatID: chatID, isFrom: isFrom, userWrap: userWrap)
                    let chatVC = self.plainspokenEqualObject(chatID: chatID, isFrom: isFrom, userWrap: userWrap)
                    //: completion?(chatVC)
                    completion?(chatVC)
                }
            }
            //: }else{
        } else {
            //: DispatchQueue.main.async {
            DispatchQueue.main.async {
                //: let chatVC = self.func__canPushToPriveteChatVC(chatID: chatID, isFrom: isFrom, userWrap: CoverThen())
                let chatVC = self.plainspokenEqualObject(chatID: chatID, isFrom: isFrom, userWrap: CoverThen())
                //: completion?(chatVC)
                completion?(chatVC)
            }
        }
    }

    //: func func__canPushToPriveteChatVC(chatID: String, isFrom: PrivateChatIsFromEnum = .Normal, userWrap: CoverThen ) -> TalkingPrivateChatController {
    func plainspokenEqualObject(chatID: String, isFrom: VoiceFromEnum = .Normal, userWrap: CoverThen) -> ClassTipsProtocol {
        //: let currentVC = func__getCurrentActivityVC()
        let currentVC = getEqualVc()
        //: if isFrom != .LiveRoom, let vcArr = currentVC?.navigationController?.viewControllers {
        if isFrom != .LiveRoom, let vcArr = currentVC?.navigationController?.viewControllers {
            //: for index in 0..<(vcArr.count) {
            for index in 0 ..< (vcArr.count) {
                //: if vcArr[index] .isKind(of: TalkingPrivateChatController.self) == true {
                if vcArr[index].isKind(of: ClassTipsProtocol.self) == true {
                    //: let vc = vcArr[index] as! TalkingPrivateChatController
                    let vc = vcArr[index] as! ClassTipsProtocol
                    //: if vc.targetId == chatID {
                    if vc.targetId == chatID {
                        //: currentVC?.navigationController?.popToViewController(vc, animated: true)
                        currentVC?.navigationController?.popToViewController(vc, animated: true)
                        //: return vc
                        return vc
                    }
                }
            }
        }

        //: let vc = TalkingPrivateChatController(chatID: chatID, isFrom: isFrom, userWrap: userWrap)
        let vc = ClassTipsProtocol(chatID: chatID, isFrom: isFrom, userWrap: userWrap)
        //: if isFrom == .LiveRoom {
        if isFrom == .LiveRoom {
            //: currentVC?.addChild(vc)
            currentVC?.addChild(vc)
            //: currentVC?.view.addSubview(vc.view)
            currentVC?.view.addSubview(vc.view)
            //: } else {
        } else {
            //: currentVC?.navigationController?.pushViewController(vc, animated: true)
            currentVC?.navigationController?.pushViewController(vc, animated: true)
        }
        //: return vc
        return vc
    }

    // MARK: - 跳转群聊

    //: func func__pushToGroupChat(groupId: String) {
    func jam(groupId: String) {
        //: guard groupId.count > 0 else { return }
        guard groupId.count > 0 else { return }
        //: ProgressHUD.show()
        StandardProgressHUD.indexRoom()
        //: BridgeReactiveCompatible.req_checkChatRoom(roomId: groupId) { succeed, result, errorModel in
        BridgeReactiveCompatible.nearBroadcastCompletion(roomId: groupId) { succeed, result, errorModel in
            //: ProgressHUD.dismiss()
            StandardProgressHUD.giftTo()
            //: guard succeed == true else {
            guard succeed == true else {
                //: if errorModel?.errorCode == 106 {
                if errorModel?.errorCode == 106 {
                    //: } else {
                } else {
                    //: self.func__showStatusBarErrorMsg(showMsg: errorModel?.errorMsg ?? "")
                    self.atShow(showMsg: errorModel?.errorMsg ?? "")
                    //: if errorModel?.errorCode == 103 {
                    if errorModel?.errorCode == 103 { // 不在家族里
                    }
                }

                //: return
                return
            }

            //: guard let data = result as? [String: Any] else {
            guard let data = result as? [String: Any] else {
                //: return
                return
            }

            //: if IconThen.isGroupChat(groupId) {
            if IconThen.barSinisterConversation(groupId) {
                //: } else {
            } else { // 公共聊天室
                //: V2TIMManager.sharedInstance().joinGroup(groupId, msg: nil) {
                V2TIMManager.sharedInstance().joinGroup(groupId, msg: nil) {
                    //: guard self.func__checkIsGroupChatVC(roomId: groupId) == false else { return }
                    guard self.digitizerId(roomId: groupId) == false else { return }
                    //: let vc = TalkingGroupChatController(groupType: GroupType_Meeting, infoData: data)
                    let vc = CustomViewController(groupType: GroupType_Meeting, infoData: data)
                    //: self.func__getCurrentActivityVC()?.navigationController?.pushViewController(vc, animated: true)
                    self.getEqualVc()?.navigationController?.pushViewController(vc, animated: true)

                    //: } fail: { code, desc in
                } fail: { code, _ in
                    //: if code == 10013 {
                    if code == 10013 { // 程序异常退出，未退出聊天室
                        //: guard self.func__checkIsGroupChatVC(roomId: groupId) == false else { return }
                        guard self.digitizerId(roomId: groupId) == false else { return }
                        //: let vc = TalkingGroupChatController(groupType: GroupType_Meeting, infoData: data)
                        let vc = CustomViewController(groupType: GroupType_Meeting, infoData: data)
                        //: self.func__getCurrentActivityVC()?.navigationController?.pushViewController(vc, animated: true)
                        self.getEqualVc()?.navigationController?.pushViewController(vc, animated: true)
                        //: } else {
                    } else {
                        //: self.func__showStatusBarErrorMsg(showMsg: "Failed to enter the chat room. Please try again later".localized)
                        self.atShow(showMsg: String(bytes: str_modelData.map{regularPart(color: $0)}, encoding: .utf8)!.localized)
                    }
                }
            }
        }
    }

    /// 检测堆栈中是否有群聊控制器，有则跳转到群聊页
    /// - Parameter roomId: 房间Id
    /// - Returns: 检测结果（true: 有; false: 无）
    //: private func func__checkIsGroupChatVC(roomId: String) -> Bool {
    private func digitizerId(roomId: String) -> Bool {
        //: let currentVC = self.func__getCurrentActivityVC()
        let currentVC = self.getEqualVc()
        //: if let vcArr = currentVC?.navigationController?.viewControllers {
        if let vcArr = currentVC?.navigationController?.viewControllers {
            //: for index in 0..<(vcArr.count) {
            for index in 0 ..< (vcArr.count) {
                //: if vcArr[index].isKind(of: TalkingGroupChatController.self) == true {
                if vcArr[index].isKind(of: CustomViewController.self) == true {
                    //: let vc = vcArr[index] as! TalkingGroupChatController
                    let vc = vcArr[index] as! CustomViewController
                    //: if vc.infoModel.roomId == roomId {
                    if vc.infoModel.roomId == roomId {
                        //: currentVC?.navigationController?.popToViewController(vc, animated: true)
                        currentVC?.navigationController?.popToViewController(vc, animated: true)
                        //: return true
                        return true
                    }
                }
            }
        }

        //: return false
        return false
    }

    // MARK: - 真人认证

    //: func func__pushUserVerifyController(toast: String?) {
    func shove(toast: String?) {
        //: let tpAuth = TPUserAuth(rawValue: WithAdministratorAppManager.share.loginUserMode.isTPAuth)
        let tpAuth = ConditionSendable(rawValue: WithAdministratorAppManager.share.loginUserMode.isTPAuth)
        //: switch(tpAuth) {
        switch tpAuth {
        //: case .unknown, .isRefused:
        case .unknown, .isRefused:
            //: let vc = TalkingFaceVerificationVC()
            let vc = WithRecognizerDelegate()
            //: vc.toastStr = toast ?? ""
            vc.toastStr = toast ?? ""
            //: let currentVC = func__getCurrentActivityVC()
            let currentVC = getEqualVc()
            //: currentVC?.navigationController?.pushViewController(vc, animated: true)
            currentVC?.navigationController?.pushViewController(vc, animated: true)

        //: case .isOnGoing:
        case .isOnGoing:
            //: let vc = TalkingFinalVerificationVC()
            let vc = CommensurateViewController()
            //: let currentVC = func__getCurrentActivityVC()
            let currentVC = getEqualVc()
            //: currentVC?.navigationController?.pushViewController(vc, animated: true)
            currentVC?.navigationController?.pushViewController(vc, animated: true)

        //: default:
        default:
            //: break
            break
        }
    }

    // MARK: - 任意用户的动态列表

    //: func func__pushUserPostListWithUid(uid: String) {
    func utiliser(uid _: String) {}

    // MARK: - 反馈feebook

    //: func func__pushFeedbackVC() {
    func goad() {
        //: let currentVC = func__getCurrentActivityVC()
        let currentVC = getEqualVc()
        //: let vc = TalkingFeedbackVC.init()
        let vc = EmptyReactiveCompatible()
        //: currentVC?.navigationController?.pushViewController(vc, animated: true)
        currentVC?.navigationController?.pushViewController(vc, animated: true)
    }

    // MARK: - 消息跳转

    //: func func__actionPushForMessage(jumpModel: TalkingMessageJumpModel) {
    func terminal(jumpModel: SendHandyJSON) {
        //: if jumpModel.jumpKey == "url" {
        if jumpModel.jumpKey == (String(str_blockValue)) {
            //: func__pushToWebVC(urlStr: jumpModel.url)
            loadWith(urlStr: jumpModel.url)
            //: } else if jumpModel.jumpKey == "userDetail"{
        } else if jumpModel.jumpKey == (str_rawData.replacingOccurrences(of: "key", with: "us") + String(str_contentValue.prefix(8))) {}
    }

    // MARK: - 会员订阅网页

    //: @objc public func func__pushToSubscribePageWebVC() {
    @objc public func numberimateVc() {
        //: LeadingEqualReactiveCompatible.share.func__pushToWebVC(webViewType: .SubscribePage)
        LeadingEqualReactiveCompatible.share.enableLine(webViewType: .SubscribePage)
    }

    // MARK: - 设置密码页面

    /// 跳转设置密码页面
    /// - Parameters:
    ///   - type: 手机号/邮箱
    ///   - content: 展示内容
    ///   - isNewPwd: 是否新设置密码（修改需要验证码）
    //: func func__pushToSetNewPasswordVC(type: LoginType, content: String, isNewPwd: Bool) {
    func red(type: MakeViewConvertible, content: String, isNewPwd: Bool) {
        //: let vc = TalkingSetNewPasswordVC()
        let vc = MakeExtraRecognizerDelegate()
        //: vc.type = type
        vc.type = type
        //: vc.content = content
        vc.content = content
        //: vc.isNewPwd = isNewPwd
        vc.isNewPwd = isNewPwd
        //: func__getCurrentActivityVC()?.navigationController?.pushViewController(vc, animated: true)
        getEqualVc()?.navigationController?.pushViewController(vc, animated: true)
    }
}

// MARK: - 跳转H5

//: extension LeadingEqualReactiveCompatible {
extension LeadingEqualReactiveCompatible {
    // 跳转全屏H5入口
    //: func func__pushToWebVC(webViewType: WebUrlType) {
    func enableLine(webViewType: MBridgeCollection) {
        //: func__pushToWebVC(webViewType: webViewType, webConfig: TalkingWebConfig())
        soulConfig(webViewType: webViewType, webConfig: HandleBladeConfig())
    }

    /// 余额不足跳转充值/订阅页
    /// - Parameters:
    ///   - clickEvent: 埋点事件
    ///   - sufficient: 余额是否充足（默认true）
    //: func func__jumpToWebRecharge(clickEvent: String = "", sufficient: Bool = true, appendParams: String = "&type=7") {
    func toParams(clickEvent: String = "", sufficient: Bool = true, appendParams: String = (String(str_modelName))) {
        //: let payWinType = WithAdministratorAppManager.share.appUserConfigMode.payWinType
        let payWinType = WithAdministratorAppManager.share.appUserConfigMode.payWinType
        // 样式：半屏充值页 || (已订阅 && 余额不足)
        //: if payWinType == 1 || (WithAdministratorAppManager.share.loginUserMode.loungePlus && sufficient == false) {
        if payWinType == 1 || (WithAdministratorAppManager.share.loginUserMode.loungePlus && sufficient == false) { // 半屏充值页
            //: func__pushToHalfWebVC(webViewType: .RechargeHalfPage, clickEvent: clickEvent)
            messageOf(webViewType: .RechargeHalfPage, clickEvent: clickEvent)

            //: } else if payWinType == 2 {
        } else if payWinType == 2 { // 会员订阅弹窗
            //: func__pushToSubscribeAlert(appendParams: appendParams)
            nowKeyLog(appendParams: appendParams)
        }
    }

    /// 跳转会员充值弹窗
    /// - Parameter appendParams: 1 私密照片、2 私密视频、3 视频包、4 音频包
    //: func func__pushToRechargeAlert(appendParams: String = "&type=0") {
    func squash(appendParams: String = (String(str_temporaryName.suffix(7)))) {
        //: var urlStr = TalkingWebManager.getFullUrl(urlType: .RechargeAlert)
        var urlStr = BarbManager.subPurchaseArray(urlType: .RechargeAlert)
        //: urlStr.append(appendParams)
        urlStr.append(appendParams)
        //: LeadingEqualReactiveCompatible.share.func__pushToWebVC(urlStr: urlStr)
        LeadingEqualReactiveCompatible.share.loadWith(urlStr: urlStr)
    }

    /// 跳转会员订阅弹窗
    /// - Parameter appendParams: url拼接参数（假视频流程拼接："&type=6；默认流程："&type=7"）
    //: func func__pushToSubscribeAlert(appendParams: String = "&type=7") {
    func nowKeyLog(appendParams: String = (String(str_modelName))) {
        //: var urlStr = TalkingWebManager.getFullUrl(urlType: .SubscribeAlert)
        var urlStr = BarbManager.subPurchaseArray(urlType: .SubscribeAlert)
        //: urlStr.append(appendParams)
        urlStr.append(appendParams)
        //: LeadingEqualReactiveCompatible.share.func__pushToWebVC(urlStr: urlStr)
        LeadingEqualReactiveCompatible.share.loadWith(urlStr: urlStr)
        // 曝光用户数埋点
        //: uploadRecord.uploadRecordEvent(eventID: subscribtionRecordButton, parameterStr: ["amount": 0])
        kLet_voiceText.workingPapers(eventID: kLet_limitStatusValue, parameterStr: [String(bytes: str_homeValue.map{legalError(log: $0)}, encoding: .utf8)!: 0])
    }

    /// 跳转半屏H5入口
    /// - Parameters:
    ///   - webViewType: 网页URL
    ///   - clickEvent: 埋点事件
    //: func func__pushToHalfWebVC(webViewType: WebUrlType, clickEvent: String = "") {
    func messageOf(webViewType: MBridgeCollection, clickEvent: String = "") {
        //: var config = TalkingWebConfig.init()
        var config = HandleBladeConfig()
        //: config.showLoadingView = false
        config.showLoadingView = false
        //: config.isHalfView = true
        config.isHalfView = true
        //: func__pushToWebVC(webViewType: webViewType, webConfig: config)
        soulConfig(webViewType: webViewType, webConfig: config)
        // 充值埋点
        //: if webViewType == .RechargeHalfPage {
        if webViewType == .RechargeHalfPage {
            //: RECHARGE_CLICK_EVENT = clickEvent
            kLet_useContent = clickEvent
            //: if clickEvent.count > 0 {
            if clickEvent.count > 0 {
                //: uploadRecord.uploadRecordEvent(eventID: clickEvent, parameterStr: ["amount": 0])
                kLet_voiceText.workingPapers(eventID: clickEvent, parameterStr: [String(bytes: str_homeValue.map{legalError(log: $0)}, encoding: .utf8)!: 0])
            }
        }
    }

    //: func func__pushToWebVC(webViewType: WebUrlType, webConfig: TalkingWebConfig) {
    func soulConfig(webViewType: MBridgeCollection, webConfig: HandleBladeConfig) {
        //: let urlStr = TalkingWebManager.getFullUrl(urlType: webViewType)
        let urlStr = BarbManager.subPurchaseArray(urlType: webViewType)
        //: func__pushToWebView(urlStr: urlStr, webViewType: webViewType, webConfig: webConfig)
        enlargement(urlStr: urlStr, webViewType: webViewType, webConfig: webConfig)
    }

    //: func func__pushToWebVC(urlStr: String?, webConfig: TalkingWebConfig? = nil) {
    func loadWith(urlStr: String?, webConfig: HandleBladeConfig? = nil) {
        //: let config = (webConfig == nil) ? TalkingWebConfig():webConfig
        let config = (webConfig == nil) ? HandleBladeConfig() : webConfig
        //: func__pushToWebView(urlStr: urlStr, webViewType: nil, webConfig: config!)
        enlargement(urlStr: urlStr, webViewType: nil, webConfig: config!)
    }

    //: func func__pushToWebView(urlStr: String?, webViewType: WebUrlType?, webConfig: TalkingWebConfig) {
    func enlargement(urlStr: String?, webViewType: MBridgeCollection?, webConfig: HandleBladeConfig) {
        //: guard urlStr != nil && urlStr != "" else { return }
        guard urlStr != nil, urlStr != "" else { return }
        //: var config = webConfig
        var config = webConfig

        // 有值且大于0，半屏按照比例展示
        //: if config.widthHeight ?? 0 > 0 {
        if config.widthHeight ?? 0 > 0 {
            //: config.isHalfView = true
            config.isHalfView = true
        }
        // 解析url中带的参数
        //: let urlParams = JSON(urlStr!.urlParameters ?? [:])
        let urlParams = JSON(urlStr!.urlParameters ?? [:])
        //: if urlParams["transparency"].stringValue == "1" { // 透明背景
        if urlParams[(String(str_blockSectionName) + str_centerErrorValue.replacingOccurrences(of: "tab", with: "ar"))].stringValue == "1" { // 透明背景
            //: config.clearBgColor = true
            config.clearBgColor = true
        }

        // url拼接参数
        //: let allowCharSet: CharacterSet = CharacterSet.init(charactersIn: "`%^{}\"[]|\\<>").inverted
        let allowCharSet = CharacterSet(charactersIn: "`%^{}\"[]|\\<>").inverted
        //: var urlStr = urlStr!.addingPercentEncoding(withAllowedCharacters: allowCharSet)!
        var urlStr = urlStr!.addingPercentEncoding(withAllowedCharacters: allowCharSet)!
        //: let otherParams = "version=\(AppNetVersion)&packageId=\(PackageID)&bundleId=\(AppBundle)"
        let otherParams = (String(str_tableValue.prefix(8))) + "\(kLet_timeTitle)" + (String(str_tapName)) + "\(kLet_nameTopText)" + (String(str_userValue.suffix(7)) + String(str_liveData.suffix(3))) + "\(kLet_recordName)"
        //: if urlStr.contains("?") {
        if urlStr.contains("?") {
            //: urlStr = "\(urlStr)&\(otherParams)"
            urlStr = "\(urlStr)&\(otherParams)"
            //: } else {
        } else {
            //: urlStr = "\(urlStr)?\(otherParams)"
            urlStr = "\(urlStr)?\(otherParams)"
        }

        //: let vc = TalkingWebViewController.init(urlString: urlStr, webViewType: webViewType, webConfig: config)
        let vc = SignReactiveCompatible(urlString: urlStr, webViewType: webViewType, webConfig: config)

        // 展示网页
        //: if let currentVC = func__getCurrentActivityVC() {
        if let currentVC = getEqualVc() {
            // 如果当前视图是模态上来的，跳转到下级时只能使用模态效果跳转
            //: var currentVCIsPresent = false
            var currentVCIsPresent = false
            //: if currentVC.isKind(of: TalkingWebViewController.self) &&
            if currentVC.isKind(of: SignReactiveCompatible.self) &&
                //: (currentVC as! TalkingWebViewController).isModal == true {
                (currentVC as! SignReactiveCompatible).isModal == true
            {
                //: currentVCIsPresent = true
                currentVCIsPresent = true
            }

            //: if config.isHalfView {
            if config.isHalfView { // 半屏使用present
                //: if config.widthHeight == nil {
                if config.widthHeight == nil {
                    //: vc.tranConfig.frameOfPresentedView = CGRect(x: 0, y: 0, width: ScreenWidth, height: ScreenHeight*2/3)
                    vc.tranConfig.frameOfPresentedView = CGRect(x: 0, y: 0, width: kLet_senseContent, height: kLet_environmentClickValue * 2 / 3)
                    //: vc.tranConfig.configCorner(corners: [.topLeft, .topRight], radius: 18)
                    vc.tranConfig.atMakeRadius(corners: [.topLeft, .topRight], radius: 18)
                    //: } else {
                } else {
                    //: vc.tranConfig.frameOfPresentedView = CGRect(x: 0, y: 0, width: ScreenWidth, height: ScreenWidth/config.widthHeight!)
                    vc.tranConfig.frameOfPresentedView = CGRect(x: 0, y: 0, width: kLet_senseContent, height: kLet_senseContent / config.widthHeight!)
                }
                //: vc.isModal = true
                vc.isModal = true
                //: currentVC.present(vc, animated: true)
                currentVC.present(vc, animated: true)

                //: } else if config.clearBgColor || currentVCIsPresent {
            } else if config.clearBgColor || currentVCIsPresent { // 透明背景只能用present
                //: vc.tranConfig.frameOfPresentedView = CGRect(x: 0, y: 0, width: ScreenWidth, height: ScreenHeight)
                vc.tranConfig.frameOfPresentedView = CGRect(x: 0, y: 0, width: kLet_senseContent, height: kLet_environmentClickValue)
                //: vc.isModal = true
                vc.isModal = true
                //: currentVC.present(vc, animated: true)
                currentVC.present(vc, animated: true)

                //: } else {
            } else {
                //: vc.isModal = false
                vc.isModal = false
                //: currentVC.navigationController?.pushViewController(vc, animated: true)
                currentVC.navigationController?.pushViewController(vc, animated: true)
            }
        }
    }
}

// MARK: - 获取当前视图、导航

//: extension LeadingEqualReactiveCompatible {
public extension LeadingEqualReactiveCompatible {
    //: @objc public func func__getCurrentActivityVC() -> UIViewController? {
    @objc func getEqualVc() -> UIViewController? {
        //: return currentViewController()
        return actionController()
    }
}

//: struct TalkingMessageJumpModel: HandyJSON {
struct SendHandyJSON: HandyJSON {
    //: var jumpKey: String?
    var jumpKey: String? // 评论的id
    //: var jumpUid: String?
    var jumpUid: String?
    //: var url: String?
    var url: String?
}
