
//: Declare String Begin

/*: "CardCellId" :*/
fileprivate let str_equalData:String = "CardCelwhite behind"
fileprivate let str_appSaveTitle:String = "type mode table data selectlId"

/*: "icon_match_dislikeBtn_nor" :*/
fileprivate let str_nextText:String = "icon_button cell size name"
fileprivate let str_userValue:String = "viewslik"
fileprivate let str_imageName:[Character] = ["_","n","o","r"]

/*: "icon_match_hiBtn_nor" :*/
fileprivate let str_toName:[Character] = ["i","c","o","n","_","m","a","t","c"]
fileprivate let str_sheCellData:[Character] = ["h","_","h","i","B","t","n","_","n","o","r"]

/*: "icon_match_likeBtn_nor" :*/
fileprivate let str_littleName:[Character] = ["i","c","o","n","_","m","a","t","c","h","_"]
fileprivate let str_groupText:[Character] = ["l","i","k","e"]
fileprivate let str_topValue:[Character] = ["B","t","n","_","n","o","r"]

/*: "Enable  Location" :*/
fileprivate let str_forceUserText:String = "item view height ifEnable"
fileprivate let str_textToTitle:String = "titletion"

/*: "lng" :*/
fileprivate let str_editValue:[UInt8] = [0x72,0x70,0x79]

private func bottomIndexSucceed(welcome num: UInt8) -> UInt8 {
    return num ^ 30
}

/*: "lat" :*/
fileprivate let str_willAwakeName:[UInt8] = [0xcb,0xc6,0xd3]

/*: "icon_match_bg_location" :*/
fileprivate let str_titleValue:String = "cameracon"
fileprivate let str_cellWithTitle:String = "user extension equalh_bg"
fileprivate let str_actionContent:[Character] = ["_","l","o","c","a","t","i","o","n"]

/*: "In order to recommend nearby people based on location, we need your permission to use location permissions" :*/
fileprivate let str_listPointIfData:[UInt8] = [0x73,0x6e,0x6f,0x69,0x73,0x73,0x69,0x6d,0x72,0x65,0x70,0x20,0x6e,0x6f,0x69,0x74,0x61,0x63,0x6f,0x6c,0x20,0x65,0x73,0x75,0x20,0x6f,0x74,0x20,0x6e,0x6f,0x69,0x73,0x73,0x69,0x6d,0x72,0x65,0x70,0x20,0x72,0x75,0x6f,0x79,0x20,0x64,0x65,0x65,0x6e,0x20,0x65,0x77,0x20,0x2c,0x6e,0x6f,0x69,0x74,0x61,0x63,0x6f,0x6c,0x20,0x6e,0x6f,0x20,0x64,0x65,0x73,0x61,0x62,0x20,0x65,0x6c,0x70,0x6f,0x65,0x70,0x20,0x79,0x62,0x72,0x61,0x65,0x6e,0x20,0x64,0x6e,0x65,0x6d,0x6d,0x6f,0x63,0x65,0x72,0x20,0x6f,0x74,0x20,0x72,0x65,0x64,0x72,0x6f,0x20,0x6e,0x49]

/*: "&type=0" :*/
fileprivate let str_safetyText:String = "manager row&type=0"

/*: "mf/business/list" :*/
fileprivate let str_requestTitle:String = "request back managermf/bus"
fileprivate let str_blackData:String = "imakee"
fileprivate let str_unprecedentedModeTitle:String = "custom viewss/list"

/*: "tab" :*/
fileprivate let str_layerData:[UInt8] = [0xd8,0xcd,0xce]

private func voiceClear(change num: UInt8) -> UInt8 {
    return num ^ 172
}

/*: "page" :*/
fileprivate let str_scriptData:[UInt8] = [0xcf,0xc0,0xc6,0xc4]

fileprivate func userTitle(on num: UInt8) -> UInt8 {
    let value = Int(num) - 95
    if value < 0 {
        return UInt8(value + 256)
    } else {
        return UInt8(value)
    }
}

/*: "minAge" :*/
fileprivate let str_labelData:[UInt8] = [0x65,0x67,0x41,0x6e,0x69,0x6d]

/*: "maxAge" :*/
fileprivate let str_behindText:[UInt8] = [0x84,0x88,0x91,0xa8,0x8e,0x8c]

private func dayMain(number num: UInt8) -> UInt8 {
    return num ^ 233
}

/*: "datingVideo" :*/
fileprivate let str_viewText:[UInt8] = [0xcb,0xce,0xdb,0xc6,0xc1,0xc8,0xf9,0xc6,0xcb,0xca,0xc0]

/*: "limitNum" :*/
fileprivate let str_backData:String = "lilayer"

/*: "expire" :*/
fileprivate let str_modelTitle:String = "push"
fileprivate let str_playObjectData:[Character] = ["x","p","i","r","e"]

/*: "Too frequent requests, please try again later" :*/
fileprivate let str_cellTimeValue:[UInt8] = [0xe3,0xd8,0xd8,0x97,0xd1,0xc5,0xd2,0xc6,0xc2,0xd2,0xd9,0xc3,0x97,0xc5,0xd2,0xc6,0xc2,0xd2,0xc4,0xc3,0xc4,0x9b,0x97,0xc7,0xdb,0xd2,0xd6,0xc4,0xd2,0x97,0xc3,0xc5,0xce,0x97,0xd6,0xd0,0xd6,0xde,0xd9,0x97,0xdb,0xd6,0xc3,0xd2,0xc5]

private func labelFail(clear num: UInt8) -> UInt8 {
    return num ^ 183
}

/*: "mf/newFeature/dislike" :*/
fileprivate let str_renderImageTitle:String = "mf/nkit detail"
fileprivate let str_atName:String = "tcellre"
fileprivate let str_toData:[Character] = ["i","k","e"]

/*: "uid" :*/
fileprivate let str_appName:[UInt8] = [0x51,0x4d,0x40]

private func borderEditHeight(top num: UInt8) -> UInt8 {
    return num ^ 36
}

/*: "mf/newFeature/like" :*/
fileprivate let str_pathName:String = "select succeedmf/new"
fileprivate let str_currentTitle:[Character] = ["F","e","a","t","u","r","e","/","l","i","k","e"]

/*: "didRemoveCell forRowAtIndex =  :*/
fileprivate let str_toValue:String = "vertical ifdidRemo"
fileprivate let str_selectedValue:[Character] = ["v","e","C","e","l","l"," ","f","o","r","R","o","w","A","t","I","n","d"]
fileprivate let str_convertData:String = "margin make requestex = "

//: Declare String End

// __DEBUG__
// __CLOSE_PRINT__
//
//  TargetThen.swift
//  AbroadTalking
//
//  Created by Charlotte on 2023/5/18.
//

//: import UIKit
import UIKit

//: import JXPagingView
import JXPagingView

//: class TalkingClubVC: TalkingBaseViewController {
class TargetThen: NameViewController {
    //: let CardCellId = "CardCellId"
    let CardCellId = (String(str_equalData.prefix(7)) + String(str_appSaveTitle.suffix(3)))

    //: var cellItems = [SocialUserListModel]()
    var cellItems = [CustomPersonHandyJSON]() ///  数据模型数据
    //: var currenModel = SocialUserListModel.init()
    var currenModel = CustomPersonHandyJSON()
    //: var currenCell: TalkingClubCardItemCell?
    var currenCell: DirectorItemCell?
    //: var isShowSubscre = false
    var isShowSubscre = false
    //: var clubUserData = Set<TalkingMatchRemoveRedoModel>()
    var clubUserData = Set<MiniskirtRedoModel>()

    //: override func viewWillAppear(_ animated: Bool) {
    override func viewWillAppear(_ animated: Bool) {
        //: super.viewWillAppear(animated)
        super.viewWillAppear(animated)
    }

    //: override func viewDidDisappear(_ animated: Bool) {
    override func viewDidDisappear(_ animated: Bool) {
        //: super.viewDidDisappear(animated)
        super.viewDidDisappear(animated)
    }

    //: override func viewDidLoad() {
    override func viewDidLoad() {
        //: super.viewDidLoad()
        super.viewDidLoad()
        //: self.hideNavi = true
        self.hideNavi = true
        //: checkLocationAuth()
        endAuth()
        //: addNotifications()
        putOnNotifications()
    }

    //: deinit {
    deinit {
        //: NotificationCenter.default.removeObserver(self)
        NotificationCenter.default.removeObserver(self)
    }

    //: private lazy var cardView: TalkingClubCardView = {
    private lazy var cardView: PreservationReactiveCompatible = {
        //: let height = ScreenHeight - TabBarViewHeight - StatusBarHeight - 117 - 12
        let height = kLet_environmentClickValue - kLet_callValue - kLet_messageContent - 117 - 12
        //: let view = TalkingClubCardView.init(frame: CGRect.init(x: 10, y: StatusBarHeight+12, width: ScreenWidth-20, height: height))
        let view = PreservationReactiveCompatible(frame: CGRect(x: 10, y: kLet_messageContent + 12, width: kLet_senseContent - 20, height: height))
        //: view.backgroundColor = .clear
        view.backgroundColor = .clear
        //: view.dataSource = self
        view.dataSource = self
        //: view.delegate = self
        view.delegate = self
        //: view.visibleCount = 10
        view.visibleCount = 10
        //: view.lineSpacing = 0.0
        view.lineSpacing = 0.0
        //: view.interitemSpacing = 0.0
        view.interitemSpacing = 0.0
        //: view.maxAngle = 0.0
        view.maxAngle = 0.0
        //: view.isAlpha = true
        view.isAlpha = true
        //: view.maxRemoveDistance = 150.0
        view.maxRemoveDistance = 150.0
        //: if LanguageManager.shared.direction == .rightToLeft {
        if MeanSunLanguageManager.shared.direction == .rightToLeft {
            //: view.maxRemoveDistance = 130.0
            view.maxRemoveDistance = 130.0
        }
        //: view.layer.cornerRadius = 10.0
        view.layer.cornerRadius = 10.0
        //: view.registerClass(cellClass: TalkingClubCardItemCell.self, forellIdentifier: CardCellId)
        view.mismanage(cellClass: DirectorItemCell.self, forellIdentifier: CardCellId)
        //: return view
        return view
        //: }()
    }()

    //: private lazy var disLikeBtn: UIButton = {
    private lazy var disLikeBtn: UIButton = {
        //: let img = UIButton()
        let img = UIButton()
        //: img.setImage(UIImage.nearCounterval(name: "icon_match_dislikeBtn_nor"), for: .normal)
        img.setImage(UIImage.nearCounterval(name: (String(str_nextText.prefix(5)) + "match_" + str_userValue.replacingOccurrences(of: "view", with: "di") + "eBtn" + String(str_imageName))), for: .normal)
        //: img.addTarget(self, action: #selector(disLikeBtnClick), for: .touchUpInside)
        img.addTarget(self, action: #selector(textProduct), for: .touchUpInside)
        //: return img
        return img
        //: }()
    }()

    //: private lazy var hiBtn: UIButton = {
    private lazy var hiBtn: UIButton = {
        //: let img = UIButton()
        let img = UIButton()
        //: img.setImage(UIImage.nearCounterval(name: "icon_match_hiBtn_nor"), for: .normal)
        img.setImage(UIImage.nearCounterval(name: (String(str_toName) + String(str_sheCellData))), for: .normal)
        //: img.addTarget(self, action: #selector(hiBtnClick), for: .touchUpInside)
        img.addTarget(self, action: #selector(hiFromMove), for: .touchUpInside)
        //: return img
        return img
        //: }()
    }()

    //: private lazy var likeBtn: UIButton = {
    private lazy var likeBtn: UIButton = {
        //: let img = UIButton()
        let img = UIButton()
        //: img.setImage(UIImage.nearCounterval(name: "icon_match_likeBtn_nor"), for: .normal)
        img.setImage(UIImage.nearCounterval(name: (String(str_littleName) + String(str_groupText) + String(str_topValue))), for: .normal)
        //: img.addTarget(self, action: #selector(likeBtnClick), for: .touchUpInside)
        img.addTarget(self, action: #selector(snapLiveClick), for: .touchUpInside)
        //: return img
        return img
        //: }()
    }()

    //: private lazy var emptyV: SocialEmptyView = {
    private lazy var emptyV: InstanceCustomReactiveCompatible = {
        //: let v = SocialEmptyView()
        let v = InstanceCustomReactiveCompatible()
        //: return v
        return v
        //: }()
    }()

    //: private lazy var locationBtn: UIButton = {
    private lazy var locationBtn: UIButton = {
        //: let btn = UIButton.init()
        let btn = UIButton()
        //: btn.setTitle("Enable  Location".localized, for: .normal)
        btn.setTitle((String(str_forceUserText.suffix(6)) + "  Loc" + str_textToTitle.replacingOccurrences(of: "title", with: "a")).localized, for: .normal)
        //: btn.titleLabel?.font = UIFont.liveAttention(type: .Medium, fontSize: 17)
        btn.titleLabel?.font = UIFont.liveAttention(type: .Medium, fontSize: 17)
        //: btn.setTitleColor(.white, for: .normal)
        btn.setTitleColor(.white, for: .normal)
        //: btn.layer.cornerRadius = 25
        btn.layer.cornerRadius = 25
        //: btn.clipsToBounds = true
        btn.clipsToBounds = true
        //: btn.setBackgroundImage(UIImage.imageGradientColor(colors: UIColor.appGradientColor(), size: CGSize(width: ScreenWidth-80, height: 50)), for: .normal)
        btn.setBackgroundImage(UIImage.nameColors(colors: UIColor.modelColor(), size: CGSize(width: kLet_senseContent - 80, height: 50)), for: .normal)
        //: btn.addTarget(self, action: #selector(locationBtnClick), for: .touchUpInside)
        btn.addTarget(self, action: #selector(northEqualObserver), for: .touchUpInside)
        //: return btn
        return btn
        //: }()
    }()

    //: private lazy var swipedFinishView: TalkingClubCardSwipedFinishView = {
    private lazy var swipedFinishView: DoingView = {
        //: let v = TalkingClubCardSwipedFinishView()
        let v = DoingView()
        //: v.countdownBlock = { [weak self] in
        v.countdownBlock = { [weak self] in
            //: guard let self = self else { return }
            guard let self = self else { return }
            //: self.beginRequestData()
            self.setOutSizeRawData()
        }
        //: view.addSubview(v)
        view.addSubview(v)
        //: v.snp.makeConstraints { make in
        v.snp.makeConstraints { make in
            //: make.edges.equalToSuperview()
            make.edges.equalToSuperview()
        }
        //: return v
        return v
        //: }()
    }()
}

// MARK: - 定位权限监听

//: extension TalkingClubVC {
extension TargetThen {
    //: func checkLocationAuth() {
    func endAuth() {
        //: TalkingLocationManager.shared().requestLocationAuthorizaiton()
        WithReactiveCompatible.home().statusUp()
        //: TalkingLocationManager.shared().getAuthBlock { [weak self] (type: PermissionType) in
        WithReactiveCompatible.home().toBlock { [weak self] (type: OptionPriorityTarget) in
            //: guard let self = self else {return}
            guard let self = self else { return }
            //: switch type {
            switch type {
            //: case .firstEntry:
            case .firstEntry: // 首次进入
                //: self.refreshViewStatus()
                self.commandGroup()

            //: case .userRestricted:
            case .userRestricted: // 拒绝
                //: self.refreshViewStatus()
                self.commandGroup()
                // 展示设置弹窗
                //: self.showSettingsAlertView()
                self.createReport()

            //: case .alwaysAllowed:
            case .alwaysAllowed: // 允许
                //: self.setupView()
                self.giftView()
                //: self.beginRequestData()
                self.setOutSizeRawData()
            }
        }
        /// 上报经纬度
        //: TalkingLocationManager.shared().getLocationBlock { success, latitude, longitude in
        WithReactiveCompatible.home().isCellSelect { success, latitude, longitude in
            //: if success {
            if success {
                //: SocialRequestManager.req_uploadPosition(params: ["lng": longitude, "lat": latitude]) { succeed, result, errorModel in
                EmptyDirectorRequestManager.sacristyShow(params: [String(bytes: str_editValue.map{bottomIndexSucceed(welcome: $0)}, encoding: .utf8)!: longitude, String(bytes: str_willAwakeName.map{$0^167}, encoding: .utf8)!: latitude]) { _, _, _ in
                }
            }
        }
    }

    /// 设置弹窗
    //: func showSettingsAlertView() {
    func createReport() {
        //: guard TalkingLocationManager.shared().locationType == .userRestricted else {
        guard WithReactiveCompatible.home().locationType == .userRestricted else {
            //: return
            return
        }
        //: self.view.addSubview(locationBtn)
        self.view.addSubview(locationBtn)
        //: locationBtn.snp.makeConstraints { make in
        locationBtn.snp.makeConstraints { make in
            //: make.bottom.equalToSuperview().offset(-33)
            make.bottom.equalToSuperview().offset(-33)
            //: make.leading.equalTo(40)
            make.leading.equalTo(40)
            //: make.trailing.equalTo(-40)
            make.trailing.equalTo(-40)
            //: make.height.equalTo(50)
            make.height.equalTo(50)
        }
    }

    /// 刷新视图状态
    //: private func refreshViewStatus() {
    private func commandGroup() {
        // 是否开启定位判断缺省图
        //: if TalkingLocationManager.shared().locationType != .alwaysAllowed {
        if WithReactiveCompatible.home().locationType != .alwaysAllowed {
            //: self.view.removeAllSubviews()
            self.view.removeAllSubviews()
            //: self.view.addSubview(emptyV)
            self.view.addSubview(emptyV)
            //: emptyV.snp.makeConstraints { make in
            emptyV.snp.makeConstraints { make in
                //: make.top.equalToSuperview().offset(200)
                make.top.equalToSuperview().offset(200)
                //: make.leading.trailing.bottom.equalToSuperview()
                make.leading.trailing.bottom.equalToSuperview()
            }
            //: emptyV.imgV.image = UIImage.nearCounterval(name: "icon_match_bg_location")
            emptyV.imgV.image = UIImage.nearCounterval(name: (str_titleValue.replacingOccurrences(of: "camera", with: "i") + "_matc" + String(str_cellWithTitle.suffix(4)) + String(str_actionContent)))
            //: emptyV.desLab.text = "In order to recommend nearby people based on location, we need your permission to use location permissions".localized
            emptyV.desLab.text = String(bytes: str_listPointIfData.reversed(), encoding: .utf8)!.localized
        }
    }

    //: @objc private func locationBtnClick() {
    @objc private func northEqualObserver() {
        //: let url = URL(string: UIApplication.openSettingsURLString)
        let url = URL(string: UIApplication.openSettingsURLString)
        //: if let url = url, UIApplication.shared.canOpenURL(url) {
        if let url = url, UIApplication.shared.canOpenURL(url) {
            //: UIApplication.shared.open(url, options: [:], completionHandler: nil)
            UIApplication.shared.open(url, options: [:], completionHandler: nil)
        }
    }
}

//: extension TalkingClubVC {
extension TargetThen {
    //: @objc private func disLikeBtnClick() {
    @objc private func textProduct() {
        // 埋点
        //: uploadRecord.uploadRecordEvent(eventID: click_home_dislike, toUid: "\(self.currenModel.uid)")
        kLet_voiceText.quantityingTime(eventID: kLet_fileValue, toUid: "\(self.currenModel.uid)")
        /// 最后一条时，无法滑动
        //: if isShowSubscre {
        if isShowSubscre {
            //: cardView.restoreCellLocation()
            cardView.compartmentLocation()
            //: LeadingEqualReactiveCompatible.share.func__pushToSubscribeAlert(appendParams: "&type=0")
            LeadingEqualReactiveCompatible.share.nowKeyLog(appendParams: (String(str_safetyText.suffix(7))))
            //: return
            return
        }
        //: disLikeReq()
        withInput()
//        if !cardView.isUserInteractionEnabled && cellItems.count == 1 {
//            self.func__showStatusBarErrorMsg(showMsg: "Too frequent requests, please try again later".localized)
//            disLikeReq()
//            return
//        }

        //: cardView.removeTopCardViewFromSwipe(direction: .Left)
        cardView.frameOf(direction: .Left)
    }

    //: @objc private func hiBtnClick() {
    @objc private func hiFromMove() {
        //: let uid = self.currenModel.uid
        let uid = self.currenModel.uid
        //: if uid > 0 {
        if uid > 0 {
            //: LeadingEqualReactiveCompatible.share.func__pushToPriveteChatVC(chatID: "\(uid)")
            LeadingEqualReactiveCompatible.share.cellRowCompletion(chatID: "\(uid)")
            // 埋点
            //: uploadRecord.uploadRecordEvent(eventID: click_home_hi, toUid: "\(uid)")
            kLet_voiceText.quantityingTime(eventID: kLet_blockData, toUid: "\(uid)")
        }
    }

    //: @objc private func likeBtnClick() {
    @objc private func snapLiveClick() {
        // 埋点
        //: uploadRecord.uploadRecordEvent(eventID: click_home_like, toUid: "\(self.currenModel.uid)")
        kLet_voiceText.quantityingTime(eventID: kLet_pointData, toUid: "\(self.currenModel.uid)")
        //: if isShowSubscre {
        if isShowSubscre {
            //: cardView.restoreCellLocation()
            cardView.compartmentLocation()
            //: LeadingEqualReactiveCompatible.share.func__pushToSubscribeAlert(appendParams: "&type=0")
            LeadingEqualReactiveCompatible.share.nowKeyLog(appendParams: (String(str_safetyText.suffix(7))))
            //: return
            return
        }
        //: likeReq()
        addQuick()
//        if !cardView.isUserInteractionEnabled && cellItems.count == 1 {
//            self.func__showStatusBarErrorMsg(showMsg: "Too frequent requests, please try again later".localized)
//            likeReq()
//            return
//        }
        //: cardView.removeTopCardViewFromSwipe(direction: .Right)
        cardView.frameOf(direction: .Right)
    }
}

/// 初始化模型数据
//: extension TalkingClubVC {
extension TargetThen {
    //: func removeAllData() {
    func videoEnable() {
        //: self.cellItems.removeAll()
        self.cellItems.removeAll()
    }

    //: func beginRequestData() {
    func setOutSizeRawData() {
        //: let reqModel = TalkingRequestModel.init()
        let reqModel = NumberryMReactiveCompatible()
        //: reqModel.showErrorStatusBar = false
        reqModel.showErrorStatusBar = false
        //: reqModel.requestPath = "mf/business/list"
        reqModel.requestPath = (String(str_requestTitle.suffix(6)) + str_blackData.replacingOccurrences(of: "make", with: "n") + String(str_unprecedentedModeTitle.suffix(7)))
        //: reqModel.requestType = .GET
        reqModel.requestType = .GET
        //: reqModel.params = ["tab": 1,
        reqModel.params = [String(bytes: str_layerData.map{voiceClear(change: $0)}, encoding: .utf8)!: 1,
                           //: "page": 0,
                           String(bytes: str_scriptData.map{userTitle(on: $0)}, encoding: .utf8)!: 0,
                           //: "minAge": 18,
                           String(bytes: str_labelData.reversed(), encoding: .utf8)!: 18,
                           //: "maxAge": 80,
                           String(bytes: str_behindText.map{dayMain(number: $0)}, encoding: .utf8)!: 80,
                           //: "datingVideo": 0]
                           String(bytes: str_viewText.map{$0^175}, encoding: .utf8)!: 0]
        //: ProgressHUD.show()
        StandardProgressHUD.indexRoom()
        //: GJ.startRequest(model: reqModel) { succeed, result, errorModel in
        kLet_deviceName.clickLocation(model: reqModel) { succeed, result, errorModel in
            //: ProgressHUD.dismiss()
            StandardProgressHUD.giftTo()
            //: guard succeed == true else {
            guard succeed == true else {
                //: if errorModel?.errorCode == 10889 {
                if errorModel?.errorCode == 10889 { // 卡片额度用完
                    //: let json = JSON(result ?? {})
                    let json = JSON(result ?? {})
                    //: self.swipedFinishView.show(limitNum: json["limitNum"].int, expire: json["expire"].int)
                    self.swipedFinishView.performExpire(limitNum: json[(str_backData.replacingOccurrences(of: "layer", with: "mi") + "tNum")].int, expire: json[(str_modelTitle.replacingOccurrences(of: "push", with: "e") + String(str_playObjectData))].int)
                    //: } else {
                } else {
                    //: if errorModel?.errorMsg.isEmpty == false {
                    if errorModel?.errorMsg.isEmpty == false {
                        //: self.func__showStatusBarErrorMsg(showMsg: errorModel?.errorMsg ?? "")
                        self.atShow(showMsg: errorModel?.errorMsg ?? "")
                    }
                    //: self.addEmptyView()
                    self.modifyView()
                }
                //: return
                return
            }
            //: let resultArr = result as! [Dictionary<String, Any>]
            let resultArr = result as! [[String: Any]]
            //: for dict in resultArr {
            for dict in resultArr {
                //: if let model = SocialUserListModel.deserialize(from: dict as? Dictionary) {
                if let model = CustomPersonHandyJSON.deserialize(from: dict as? Dictionary) {
                    //: self.cellItems.append(model)
                    self.cellItems.append(model)
                }
            }
            //: if self.cellItems.count > 0 {
            if self.cellItems.count > 0 {
                //: self.swipedFinishView.dismiss()
                self.swipedFinishView.para()
                //: if resultArr.count > 0 {
                if resultArr.count > 0 {
//                    if self.cellItems.count == 1 {
//                        self.cardView.isUserInteractionEnabled = false
//                    }else {
//                        self.cardView.isUserInteractionEnabled = true
//                    }
                    //: self.cardView.reloadData()
                    self.cardView.popIn()
                    //: }else {
                } else {
                    //: self.func__showStatusBarErrorMsg(showMsg: "Too frequent requests, please try again later".localized)
                    self.atShow(showMsg: String(bytes: str_cellTimeValue.map{labelFail(clear: $0)}, encoding: .utf8)!.localized)
                }
                //: } else {
            } else {
                //: self.swipedFinishView.show(limitNum: nil, expire: nil)
                self.swipedFinishView.performExpire(limitNum: nil, expire: nil)
            }
        }
    }

    //: private func addEmptyView() {
    private func modifyView() {
        //: self.view.removeAllSubviews()
        self.view.removeAllSubviews()
        //: self.view.addSubview(self.emptyV)
        self.view.addSubview(self.emptyV)
        //: self.emptyV.snp.makeConstraints { make in
        self.emptyV.snp.makeConstraints { make in
            //: make.top.equalToSuperview().offset(200)
            make.top.equalToSuperview().offset(200)
            //: make.leading.trailing.bottom.equalToSuperview()
            make.leading.trailing.bottom.equalToSuperview()
        }
    }

    //: private func disLikeReq() {
    private func withInput() {
        //: let reqModel = TalkingRequestModel.init()
        let reqModel = NumberryMReactiveCompatible()
        //: reqModel.requestPath = "mf/newFeature/dislike"
        reqModel.requestPath = (String(str_renderImageTitle.prefix(4)) + "ewFea" + str_atName.replacingOccurrences(of: "cell", with: "u") + "/disl" + String(str_toData))
        //: reqModel.requestType = .POST
        reqModel.requestType = .POST
        //: reqModel.params = ["uid": self.currenModel.uid]
        reqModel.params = [String(bytes: str_appName.map{borderEditHeight(top: $0)}, encoding: .utf8)!: self.currenModel.uid]
        //: reqModel.showErrorStatusBar = false
        reqModel.showErrorStatusBar = false

        //: GJ.startRequest(model: reqModel) { succeed, result, errorModel in
        kLet_deviceName.clickLocation(model: reqModel) { _, result, errorModel in
            //: if errorModel?.errorMsg.isEmpty == false {
            if errorModel?.errorMsg.isEmpty == false {
                //: self.func__showStatusBarErrorMsg(showMsg: errorModel?.errorMsg ?? "")
                self.atShow(showMsg: errorModel?.errorMsg ?? "")
            }
            //: if errorModel?.errorCode == 10888 {
            if errorModel?.errorCode == 10888 {
                //: LeadingEqualReactiveCompatible.share.func__pushToSubscribeAlert(appendParams: "&type=0")
                LeadingEqualReactiveCompatible.share.nowKeyLog(appendParams: (String(str_safetyText.suffix(7))))
                //: self.isShowSubscre = true
                self.isShowSubscre = true

                //: } else if errorModel?.errorCode == 10889 {
            } else if errorModel?.errorCode == 10889 { // 卡片额度用完
                //: let json = JSON(result ?? {})
                let json = JSON(result ?? {})
                //: self.swipedFinishView.show(limitNum: json["limitNum"].int, expire: json["expire"].int)
                self.swipedFinishView.performExpire(limitNum: json[(str_backData.replacingOccurrences(of: "layer", with: "mi") + "tNum")].int, expire: json[(str_modelTitle.replacingOccurrences(of: "push", with: "e") + String(str_playObjectData))].int)
            }
        }
    }

    //: private func likeReq() {
    private func addQuick() {
        //: let reqModel = TalkingRequestModel.init()
        let reqModel = NumberryMReactiveCompatible()
        //: reqModel.requestPath = "mf/newFeature/like"
        reqModel.requestPath = (String(str_pathName.suffix(6)) + String(str_currentTitle))
        //: reqModel.requestType = .POST
        reqModel.requestType = .POST
        //: reqModel.params = ["uid": self.currenModel.uid]
        reqModel.params = [String(bytes: str_appName.map{borderEditHeight(top: $0)}, encoding: .utf8)!: self.currenModel.uid]
        //: reqModel.showErrorStatusBar = false
        reqModel.showErrorStatusBar = false

        //: GJ.startRequest(model: reqModel) { succeed, result, errorModel in
        kLet_deviceName.clickLocation(model: reqModel) { _, result, errorModel in
            //: if errorModel?.errorMsg.isEmpty == false {
            if errorModel?.errorMsg.isEmpty == false {
                //: self.func__showStatusBarErrorMsg(showMsg: errorModel?.errorMsg ?? "")
                self.atShow(showMsg: errorModel?.errorMsg ?? "")
            }
            //: if errorModel?.errorCode == 10888 {
            if errorModel?.errorCode == 10888 {
                //: LeadingEqualReactiveCompatible.share.func__pushToSubscribeAlert(appendParams: "&type=0")
                LeadingEqualReactiveCompatible.share.nowKeyLog(appendParams: (String(str_safetyText.suffix(7))))
                //: self.isShowSubscre = true
                self.isShowSubscre = true

                //: } else if errorModel?.errorCode == 10889 {
            } else if errorModel?.errorCode == 10889 { // 卡片额度用完
                //: let json = JSON(result ?? {})
                let json = JSON(result ?? {})
                //: self.swipedFinishView.show(limitNum: json["limitNum"].intValue, expire: json["expire"].intValue)
                self.swipedFinishView.performExpire(limitNum: json[(str_backData.replacingOccurrences(of: "layer", with: "mi") + "tNum")].intValue, expire: json[(str_modelTitle.replacingOccurrences(of: "push", with: "e") + String(str_playObjectData))].intValue)
            }
        }
    }

    /// 刷新个人资料接口
    //: @objc private func func__requestUserInfo() {
    @objc private func tapFor() {
        //: AppManagerRequest.func__requestUserInfo { succeed, result, errorModel in
        CustomThen.adRequest { _, _, _ in
            //: self.isShowSubscre = false
            self.isShowSubscre = false
            //: self.beginRequestData()
            self.setOutSizeRawData()
        }
    }
}

//: extension TalkingClubVC: TalkingClubCardViewDataSource, TalkingClubCardViewDelegate {
extension TargetThen: ManagerVolumeDataSource, FromCollectionViewDelegate {
    //: func numberOfCountInCardView(cardView: TalkingClubCardView) -> Int {
    func numberVideoView(cardView _: PreservationReactiveCompatible) -> Int {
        //: return cellItems.count
        return cellItems.count
    }

    //: func cardViewCellForRowAtIndex(cardView: TalkingClubCardView, index: Int) -> TalkingClubCardViewCell {
    func fromWith(cardView: PreservationReactiveCompatible, index: Int) -> SignView {
        //: let cell = cardView.dequeueReusableCellWithIdentifier(identifier: CardCellId) as? TalkingClubCardItemCell
        let cell = cardView.emptyDoing(identifier: CardCellId) as? DirectorItemCell
        //: let model = cellItems[index]
        let model = cellItems[index]
        //: cell?.setCellData(model: model)
        cell?.sharedRecord(model: model)
        //: if index == 0 {
        if index == 0 {
            //: self.currenModel = model
            self.currenModel = model
            //: self.currenCell = cell
            self.currenCell = cell
        }

        //: cell?.layer.cornerRadius = 10.0
        cell?.layer.cornerRadius = 10.0
        //: cell?.layer.masksToBounds = true
        cell?.layer.masksToBounds = true
        //: return cell!
        return cell!
    }

    //: func CellForRowAtIndexModel(index: Int) -> SocialUserListModel {
    func terraceIndex(index: Int) -> CustomPersonHandyJSON {
        //: let model = cellItems[index]
        let model = cellItems[index]
        //: return model
        return model
    }

    //: func didRemoveLastCell(cardViewCell: TalkingClubCardViewCell, forRowAtIndex: Int) {
    func outWrite(cardViewCell _: SignView, forRowAtIndex _: Int) {
        /// 数据查看完
        //: self.removeAllData()
        self.videoEnable()
//        cardView.isUserInteractionEnabled = false
        //: beginRequestData()
        setOutSizeRawData()
    }

    //: func didRemoveCell(cardView: TalkingClubCardView, cardViewCell: TalkingClubCardViewCell, forRowAtIndex: Int, direction: Int, isGesture: Bool) {
    func titleTarget(cardView _: PreservationReactiveCompatible, cardViewCell _: SignView, forRowAtIndex: Int, direction: Int, isGesture: Bool) {
        //: if isGesture {
        if isGesture {
            //: if direction == 1 {
            if direction == 1 {
                // 埋点
                //: uploadRecord.uploadRecordEvent(eventID: click_home_dislike, toUid: "\(self.currenModel.uid)")
                kLet_voiceText.quantityingTime(eventID: kLet_fileValue, toUid: "\(self.currenModel.uid)")
                //: disLikeReq()
                withInput()
                //: }else {
            } else {
                // 埋点
                //: uploadRecord.uploadRecordEvent(eventID: click_home_like, toUid: "\(self.currenModel.uid)")
                kLet_voiceText.quantityingTime(eventID: kLet_pointData, toUid: "\(self.currenModel.uid)")
                //: likeReq()
                addQuick()
            }
        }
        //: cellItems.remove(at: 0)
        cellItems.remove(at: 0)
        //: if let model = cellItems.first {
        if let model = cellItems.first {
            //: self.currenModel = model
            self.currenModel = model
        }

        /// 最后一条
//        if cellItems.count == 1 {
//            cardView.isUserInteractionEnabled = false
//            beginRequestData()
//        }
        //: printLog(message:"didRemoveCell forRowAtIndex = \(forRowAtIndex)")
        printLog(message: (String(str_toValue.suffix(7)) + String(str_selectedValue) + String(str_convertData.suffix(5))) + "\(forRowAtIndex)")
    }

    //: func didDisplayCell(cardViewCell: TalkingClubCardViewCell, forRowAtIndex: Int) {
    func finishBlock(cardViewCell _: SignView, forRowAtIndex _: Int) {}

    //: func didMoveCell(cardView: TalkingClubCardView, cardViewCell: TalkingClubCardViewCell, forMovePoint: CGPoint) {
    func movePoint(cardView _: PreservationReactiveCompatible, cardViewCell _: SignView, forMovePoint _: CGPoint) {}

    //: func beginMoveCell(cardView: TalkingClubCardView, cardViewCell: TalkingClubCardViewCell) {
    func climax(cardView _: PreservationReactiveCompatible, cardViewCell _: SignView) {
//        if isShowSubscre {
//            cardView.isUserInteractionEnabled = false
//        }
    }
}

//: extension TalkingClubVC {
extension TargetThen {
    //: private func setupView() {
    private func giftView() {
        //: self.view.backgroundColor = .clear
        self.view.backgroundColor = .clear
        //: self.view.removeAllSubviews()
        self.view.removeAllSubviews()
        //: self.view.addSubview(cardView)
        self.view.addSubview(cardView)
        //: self.view.addSubview(disLikeBtn)
        self.view.addSubview(disLikeBtn)
        //: self.view.addSubview(hiBtn)
        self.view.addSubview(hiBtn)
        //: self.view.addSubview(likeBtn)
        self.view.addSubview(likeBtn)

        //: hiBtn.snp.makeConstraints { make in
        hiBtn.snp.makeConstraints { make in
            //: make.top.equalTo(cardView.snp.bottom).offset(28)
            make.top.equalTo(cardView.snp.bottom).offset(28)
            //: make.centerX.equalTo(self.view)
            make.centerX.equalTo(self.view)
            //: make.size.equalTo(61)
            make.size.equalTo(61)
        }

        //: disLikeBtn.snp.makeConstraints { make in
        disLikeBtn.snp.makeConstraints { make in
            //: make.size.top.equalTo(hiBtn)
            make.size.top.equalTo(hiBtn)
            //: make.trailing.equalTo(hiBtn.snp.leading).offset(-48)
            make.trailing.equalTo(hiBtn.snp.leading).offset(-48)
        }

        //: likeBtn.snp.makeConstraints { make in
        likeBtn.snp.makeConstraints { make in
            //: make.size.top.equalTo(hiBtn)
            make.size.top.equalTo(hiBtn)
            //: make.leading.equalTo(hiBtn.snp.trailing).offset(48)
            make.leading.equalTo(hiBtn.snp.trailing).offset(48)
        }
    }

    /// 添加通知
    //: private func addNotifications() {
    private func putOnNotifications() {
        //: NotificationCenter.default.addObserver(self,
        NotificationCenter.default.addObserver(self,
                                               //: selector: #selector(self.func__requestUserInfo),
                                               selector: #selector(self.tapFor),
                                               //: name: USER_UPDATE_LOUNGEPLUSINFO_NOTIFICATION,
                                               name: kLet_greetData,
                                               //: object: nil)
                                               object: nil)
    }
}
